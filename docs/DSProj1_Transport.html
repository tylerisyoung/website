<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Tyler Young" />


<title>Public Transportation Time Series Analysis</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="Lightheartedhumans.html">Lighthearted Humans</a>
</li>
<li>
  <a href="Film.html">Film</a>
</li>
<li>
  <a href="Photography.html">Photography</a>
</li>
<li>
  <a href="Journalism.html">Journalism</a>
</li>
<li>
  <a href="datascience.html">Data Science</a>
</li>
<li>
  <a href="Contact.html">Contact</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Public Transportation Time Series Analysis</h1>
<h4 class="author">Tyler Young</h4>

</div>


<p><br> <br></p>
<div id="policy-question" class="section level1">
<h1>Policy Question:</h1>
<div id="does-adding-more-bussed-to-a-public-transportation-like-increase-ridership-in-a-city" class="section level4">
<h4>Does adding more bussed to a public transportation like increase ridership in a city?</h4>
</div>
<div id="load-data" class="section level4">
<h4>Load Data</h4>
<p>Assigning example passenger data to a variable, and creating a control and a treatment group for analysis divided by each half of attendance throughout the year &amp; putting this within a datframe for analysis and visualization.</p>
<p>Example Data from <a href="https://github.com/DS4PS/pe4ps-textbook/blob/master/data/time-series-example.rds?raw=true">DS4PS Github</a>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="co">#Passenger data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a>passengers &lt;-<span class="st"> </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a><span class="kw">c</span>(<span class="dv">1328</span>, <span class="dv">1407</span>, <span class="dv">1425</span>, <span class="dv">1252</span>, <span class="dv">1287</span>, <span class="dv">1353</span>, <span class="dv">1301</span>, <span class="dv">1294</span>, <span class="dv">1336</span>, <span class="dv">1371</span>, </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a><span class="dv">1408</span>, <span class="dv">1326</span>, <span class="dv">1364</span>, <span class="dv">1295</span>, <span class="dv">1320</span>, <span class="dv">1260</span>, <span class="dv">1347</span>, <span class="dv">1316</span>, <span class="dv">1287</span>, <span class="dv">1292</span>, <span class="dv">1259</span>, </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a><span class="dv">1349</span>, <span class="dv">1274</span>, <span class="dv">1365</span>, <span class="dv">1317</span>, <span class="dv">1341</span>, <span class="dv">1316</span>, <span class="dv">1313</span>, <span class="dv">1285</span>, <span class="dv">1369</span>, <span class="dv">1309</span>, <span class="dv">1446</span>, </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true"></a><span class="dv">1422</span>, <span class="dv">1397</span>, <span class="dv">1358</span>, <span class="dv">1310</span>, <span class="dv">1294</span>, <span class="dv">1373</span>, <span class="dv">1161</span>, <span class="dv">1320</span>, <span class="dv">1376</span>, <span class="dv">1335</span>, <span class="dv">1382</span>, </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true"></a><span class="dv">1455</span>, <span class="dv">1374</span>, <span class="dv">1267</span>, <span class="dv">1318</span>, <span class="dv">1370</span>, <span class="dv">1297</span>, <span class="dv">1391</span>, <span class="dv">1269</span>, <span class="dv">1341</span>, <span class="dv">1238</span>, <span class="dv">1391</span>, </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true"></a><span class="dv">1296</span>, <span class="dv">1260</span>, <span class="dv">1330</span>, <span class="dv">1447</span>, <span class="dv">1296</span>, <span class="dv">1389</span>, <span class="dv">1278</span>, <span class="dv">1319</span>, <span class="dv">1333</span>, <span class="dv">1372</span>, <span class="dv">1325</span>, </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true"></a><span class="dv">1299</span>, <span class="dv">1299</span>, <span class="dv">1312</span>, <span class="dv">1352</span>, <span class="dv">1355</span>, <span class="dv">1404</span>, <span class="dv">1317</span>, <span class="dv">1330</span>, <span class="dv">1325</span>, <span class="dv">1368</span>, <span class="dv">1311</span>, </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true"></a><span class="dv">1310</span>, <span class="dv">1242</span>, <span class="dv">1247</span>, <span class="dv">1366</span>, <span class="dv">1401</span>, <span class="dv">1282</span>, <span class="dv">1298</span>, <span class="dv">1301</span>, <span class="dv">1341</span>, <span class="dv">1353</span>, <span class="dv">1398</span>, </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true"></a><span class="dv">1352</span>, <span class="dv">1300</span>, <span class="dv">1442</span>, <span class="dv">1365</span>, <span class="dv">1411</span>, <span class="dv">1360</span>, <span class="dv">1100</span>, <span class="dv">1334</span>, <span class="dv">1336</span>, <span class="dv">1274</span>, <span class="dv">1303</span>, </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true"></a><span class="dv">1487</span>, <span class="dv">1341</span>, <span class="dv">1436</span>, <span class="dv">1294</span>, <span class="dv">1390</span>, <span class="dv">1338</span>, <span class="dv">1400</span>, <span class="dv">1325</span>, <span class="dv">1352</span>, <span class="dv">1353</span>, <span class="dv">1288</span>, </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true"></a><span class="dv">1304</span>, <span class="dv">1338</span>, <span class="dv">1355</span>, <span class="dv">1212</span>, <span class="dv">1386</span>, <span class="dv">1426</span>, <span class="dv">1380</span>, <span class="dv">1425</span>, <span class="dv">1287</span>, <span class="dv">1337</span>, <span class="dv">1288</span>, </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true"></a><span class="dv">1348</span>, <span class="dv">1308</span>, <span class="dv">1402</span>, <span class="dv">1370</span>, <span class="dv">1401</span>, <span class="dv">1363</span>, <span class="dv">1312</span>, <span class="dv">1457</span>, <span class="dv">1367</span>, <span class="dv">1320</span>, <span class="dv">1338</span>, </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true"></a><span class="dv">1447</span>, <span class="dv">1371</span>, <span class="dv">1402</span>, <span class="dv">1461</span>, <span class="dv">1382</span>, <span class="dv">1260</span>, <span class="dv">1341</span>, <span class="dv">1309</span>, <span class="dv">1317</span>, <span class="dv">1509</span>, <span class="dv">1403</span>, </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true"></a><span class="dv">1324</span>, <span class="dv">1347</span>, <span class="dv">1351</span>, <span class="dv">1307</span>, <span class="dv">1267</span>, <span class="dv">1312</span>, <span class="dv">1472</span>, <span class="dv">1403</span>, <span class="dv">1327</span>, <span class="dv">1501</span>, <span class="dv">1470</span>, </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true"></a><span class="dv">1438</span>, <span class="dv">1416</span>, <span class="dv">1369</span>, <span class="dv">1355</span>, <span class="dv">1317</span>, <span class="dv">1448</span>, <span class="dv">1423</span>, <span class="dv">1401</span>, <span class="dv">1356</span>, <span class="dv">1400</span>, <span class="dv">1356</span>, </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true"></a><span class="dv">1452</span>, <span class="dv">1435</span>, <span class="dv">1387</span>, <span class="dv">1372</span>, <span class="dv">1390</span>, <span class="dv">1538</span>, <span class="dv">1460</span>, <span class="dv">1474</span>, <span class="dv">1510</span>, <span class="dv">1360</span>, <span class="dv">1424</span>, </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true"></a><span class="dv">1275</span>, <span class="dv">1381</span>, <span class="dv">1453</span>, <span class="dv">1430</span>, <span class="dv">1404</span>, <span class="dv">1350</span>, <span class="dv">1375</span>, <span class="dv">1327</span>, <span class="dv">1312</span>, <span class="dv">1464</span>, <span class="dv">1478</span>, </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true"></a><span class="dv">1536</span>, <span class="dv">1397</span>, <span class="dv">1229</span>, <span class="dv">1337</span>, <span class="dv">1442</span>, <span class="dv">1316</span>, <span class="dv">1455</span>, <span class="dv">1312</span>, <span class="dv">1505</span>, <span class="dv">1440</span>, <span class="dv">1408</span>, </span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true"></a><span class="dv">1429</span>, <span class="dv">1280</span>, <span class="dv">1560</span>, <span class="dv">1422</span>, <span class="dv">1363</span>, <span class="dv">1349</span>, <span class="dv">1326</span>, <span class="dv">1400</span>, <span class="dv">1464</span>, <span class="dv">1488</span>, <span class="dv">1352</span>, </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true"></a><span class="dv">1485</span>, <span class="dv">1446</span>, <span class="dv">1540</span>, <span class="dv">1435</span>, <span class="dv">1377</span>, <span class="dv">1287</span>, <span class="dv">1480</span>, <span class="dv">1353</span>, <span class="dv">1359</span>, <span class="dv">1493</span>, <span class="dv">1387</span>, </span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true"></a><span class="dv">1314</span>, <span class="dv">1478</span>, <span class="dv">1306</span>, <span class="dv">1462</span>, <span class="dv">1533</span>, <span class="dv">1261</span>, <span class="dv">1488</span>, <span class="dv">1482</span>, <span class="dv">1461</span>, <span class="dv">1452</span>, <span class="dv">1540</span>, </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true"></a><span class="dv">1438</span>, <span class="dv">1423</span>, <span class="dv">1425</span>, <span class="dv">1353</span>, <span class="dv">1489</span>, <span class="dv">1546</span>, <span class="dv">1401</span>, <span class="dv">1459</span>, <span class="dv">1527</span>, <span class="dv">1341</span>, <span class="dv">1516</span>, </span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true"></a><span class="dv">1406</span>, <span class="dv">1414</span>, <span class="dv">1442</span>, <span class="dv">1272</span>, <span class="dv">1371</span>, <span class="dv">1435</span>, <span class="dv">1446</span>, <span class="dv">1287</span>, <span class="dv">1496</span>, <span class="dv">1442</span>, <span class="dv">1614</span>, </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true"></a><span class="dv">1305</span>, <span class="dv">1459</span>, <span class="dv">1342</span>, <span class="dv">1478</span>, <span class="dv">1501</span>, <span class="dv">1357</span>, <span class="dv">1428</span>, <span class="dv">1444</span>, <span class="dv">1431</span>, <span class="dv">1425</span>, <span class="dv">1434</span>, </span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true"></a><span class="dv">1488</span>, <span class="dv">1508</span>, <span class="dv">1454</span>, <span class="dv">1436</span>, <span class="dv">1485</span>, <span class="dv">1522</span>, <span class="dv">1437</span>, <span class="dv">1396</span>, <span class="dv">1407</span>, <span class="dv">1382</span>, <span class="dv">1444</span>, </span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true"></a><span class="dv">1494</span>, <span class="dv">1303</span>, <span class="dv">1552</span>, <span class="dv">1282</span>, <span class="dv">1352</span>, <span class="dv">1412</span>, <span class="dv">1378</span>, <span class="dv">1579</span>, <span class="dv">1543</span>, <span class="dv">1425</span>, <span class="dv">1404</span>, </span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true"></a><span class="dv">1380</span>, <span class="dv">1593</span>, <span class="dv">1555</span>, <span class="dv">1532</span>, <span class="dv">1514</span>, <span class="dv">1485</span>, <span class="dv">1504</span>, <span class="dv">1442</span>, <span class="dv">1401</span>, <span class="dv">1453</span>, <span class="dv">1493</span>, </span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true"></a><span class="dv">1522</span>, <span class="dv">1417</span>, <span class="dv">1545</span>, <span class="dv">1422</span>, <span class="dv">1540</span>, <span class="dv">1447</span>, <span class="dv">1447</span>, <span class="dv">1575</span>, <span class="dv">1431</span>, <span class="dv">1516</span>, <span class="dv">1542</span>, </span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true"></a><span class="dv">1519</span>, <span class="dv">1485</span>, <span class="dv">1526</span>, <span class="dv">1400</span>, <span class="dv">1563</span>, <span class="dv">1471</span>, <span class="dv">1517</span>, <span class="dv">1506</span>, <span class="dv">1514</span>, <span class="dv">1444</span>, <span class="dv">1348</span>, </span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true"></a><span class="dv">1588</span>, <span class="dv">1574</span>, <span class="dv">1275</span>, <span class="dv">1331</span>, <span class="dv">1436</span>, <span class="dv">1475</span>, <span class="dv">1570</span>, <span class="dv">1513</span>, <span class="dv">1469</span>, <span class="dv">1573</span>, <span class="dv">1432</span>, </span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true"></a><span class="dv">1467</span>, <span class="dv">1513</span>, <span class="dv">1475</span>, <span class="dv">1572</span>, <span class="dv">1430</span>, <span class="dv">1512</span>, <span class="dv">1532</span>, <span class="dv">1487</span>, <span class="dv">1474</span>, <span class="dv">1508</span>, <span class="dv">1410</span>, </span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true"></a><span class="dv">1455</span>, <span class="dv">1445</span>, <span class="dv">1544</span>, <span class="dv">1500</span>, <span class="dv">1517</span>, <span class="dv">1496</span>, <span class="dv">1606</span>, <span class="dv">1613</span>, <span class="dv">1526</span>, <span class="dv">1487</span>, <span class="dv">1540</span>, </span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true"></a><span class="dv">1511</span>, <span class="dv">1534</span>, <span class="dv">1620</span>, <span class="dv">1409</span>, <span class="dv">1542</span>, <span class="dv">1517</span>, <span class="dv">1493</span>, <span class="dv">1443</span>, <span class="dv">1463</span>, <span class="dv">1391</span>, <span class="dv">1583</span>, </span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true"></a><span class="dv">1516</span>, <span class="dv">1700</span>, <span class="dv">1422</span>)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true"></a></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true"></a>time &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">365</span>  <span class="co"># or 1:length(passengers) </span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true"></a><span class="co"># sequence of 5 zeros followed by 5 ones:</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true"></a>treat &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">182</span>), <span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">183</span>) )</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true"></a><span class="co"># or using an ifelse statement since we know it starts in period 6</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true"></a>treat &lt;-<span class="st"> </span><span class="kw">ifelse</span>( time <span class="op">&gt;</span><span class="st"> </span><span class="dv">182</span>, <span class="dv">1</span>, <span class="dv">0</span> )</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true"></a><span class="co"># sequence of 5 zeros followed by new counter</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true"></a>time.since &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">182</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">183</span> )</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true"></a>d &lt;-<span class="st"> </span><span class="kw">data.frame</span>( passengers, time, treat, time.since )</span></code></pre></div>
<p><br> <br></p>
<p>Preview data then differentiating passengers between treatment and control groups into time periods.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="kw">head</span>(d, <span class="dt">n=</span><span class="dv">5</span>)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["passengers"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["time"],"name":[2],"type":["int"],"align":["right"]},{"label":["treat"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["time.since"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"1328","2":"1","3":"0","4":"0","_rn_":"1"},{"1":"1407","2":"2","3":"0","4":"0","_rn_":"2"},{"1":"1425","2":"3","3":"0","4":"0","_rn_":"3"},{"1":"1252","2":"4","3":"0","4":"0","_rn_":"4"},{"1":"1287","2":"5","3":"0","4":"0","_rn_":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a>d<span class="op">$</span>passengers &lt;-<span class="st"> </span><span class="kw">round</span>(d<span class="op">$</span>passengers,<span class="dv">1</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a>d.sum &lt;-<span class="st"> </span><span class="kw">rbind</span>( <span class="kw">head</span>(d), <span class="kw">c</span>(<span class="st">&quot;...&quot;</span>,<span class="st">&quot;...&quot;</span>,<span class="st">&quot;...&quot;</span>,<span class="st">&quot;...&quot;</span>),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a>                 d[ <span class="dv">181</span><span class="op">:</span><span class="dv">184</span>, ], </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a>                 <span class="kw">c</span>(<span class="st">&quot;**START**&quot;</span>,<span class="st">&quot;**TREATMENT**&quot;</span>,<span class="st">&quot;---&quot;</span>,<span class="st">&quot;---&quot;</span>), </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a>                 d[ <span class="dv">185</span><span class="op">:</span><span class="dv">189</span>, ],  </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true"></a>                 <span class="kw">c</span>(<span class="st">&quot;...&quot;</span>,<span class="st">&quot;...&quot;</span>,<span class="st">&quot;...&quot;</span>,<span class="st">&quot;...&quot;</span>),</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true"></a>                 <span class="kw">tail</span>(d) )</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true"></a><span class="kw">row.names</span>( d.sum ) &lt;-<span class="st"> </span><span class="ot">NULL</span>  </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true"></a><span class="kw">pander</span>( d.sum )</span></code></pre></div>
<table style="width:69%;">
<colgroup>
<col width="18%" />
<col width="22%" />
<col width="11%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">passengers</th>
<th align="center">time</th>
<th align="center">treat</th>
<th align="center">time.since</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1328</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">1407</td>
<td align="center">2</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">1425</td>
<td align="center">3</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">1252</td>
<td align="center">4</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">1287</td>
<td align="center">5</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">1353</td>
<td align="center">6</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">…</td>
<td align="center">…</td>
<td align="center">…</td>
<td align="center">…</td>
</tr>
<tr class="even">
<td align="center">1350</td>
<td align="center">181</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">1375</td>
<td align="center">182</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">1327</td>
<td align="center">183</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="center">1312</td>
<td align="center">184</td>
<td align="center">1</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="center"><strong>START</strong></td>
<td align="center"><strong>TREATMENT</strong></td>
<td align="center">—</td>
<td align="center">—</td>
</tr>
<tr class="odd">
<td align="center">1464</td>
<td align="center">185</td>
<td align="center">1</td>
<td align="center">3</td>
</tr>
<tr class="even">
<td align="center">1478</td>
<td align="center">186</td>
<td align="center">1</td>
<td align="center">4</td>
</tr>
<tr class="odd">
<td align="center">1536</td>
<td align="center">187</td>
<td align="center">1</td>
<td align="center">5</td>
</tr>
<tr class="even">
<td align="center">1397</td>
<td align="center">188</td>
<td align="center">1</td>
<td align="center">6</td>
</tr>
<tr class="odd">
<td align="center">1229</td>
<td align="center">189</td>
<td align="center">1</td>
<td align="center">7</td>
</tr>
<tr class="even">
<td align="center">…</td>
<td align="center">…</td>
<td align="center">…</td>
<td align="center">…</td>
</tr>
<tr class="odd">
<td align="center">1463</td>
<td align="center">360</td>
<td align="center">1</td>
<td align="center">178</td>
</tr>
<tr class="even">
<td align="center">1391</td>
<td align="center">361</td>
<td align="center">1</td>
<td align="center">179</td>
</tr>
<tr class="odd">
<td align="center">1583</td>
<td align="center">362</td>
<td align="center">1</td>
<td align="center">180</td>
</tr>
<tr class="even">
<td align="center">1516</td>
<td align="center">363</td>
<td align="center">1</td>
<td align="center">181</td>
</tr>
<tr class="odd">
<td align="center">1700</td>
<td align="center">364</td>
<td align="center">1</td>
<td align="center">182</td>
</tr>
<tr class="even">
<td align="center">1422</td>
<td align="center">365</td>
<td align="center">1</td>
<td align="center">183</td>
</tr>
</tbody>
</table>
<p><br> <br> <br> <br> <br></p>
<p>Plot passengers ridership by days with inflection point for analysis on treatment group.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="kw">plot</span>( d<span class="op">$</span>time, d<span class="op">$</span>passengers,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a>      <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="st">&quot;gray&quot;</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a>      <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">1000</span>, <span class="dv">2000</span>), <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">400</span>),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a>      <span class="dt">xlab =</span> <span class="st">&quot;Time (days)&quot;</span>, </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a>      <span class="dt">ylab =</span> <span class="st">&quot;Ridership&quot;</span> )</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a><span class="co"># Line marking the interruption</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true"></a><span class="kw">abline</span>( <span class="dt">v=</span><span class="dv">200</span>, <span class="dt">col=</span><span class="st">&quot;firebrick&quot;</span>, <span class="dt">lty=</span><span class="dv">2</span> )</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true"></a><span class="kw">text</span>( <span class="dv">195</span>, <span class="dv">2000</span>, <span class="st">&quot;Start of New Bus Schedule&quot;</span>, <span class="dt">col=</span><span class="st">&quot;firebrick&quot;</span>, <span class="dt">cex=</span><span class="fl">1.3</span>, <span class="dt">pos=</span><span class="dv">4</span> )</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true"></a><span class="co"># Add the regression line</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true"></a>ts &lt;-<span class="st"> </span><span class="kw">lm</span>( passengers <span class="op">~</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span>treat <span class="op">+</span><span class="st"> </span>time.since, <span class="dt">data=</span>d )</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true"></a><span class="kw">lines</span>( d<span class="op">$</span>time, ts<span class="op">$</span>fitted.values, <span class="dt">col=</span><span class="st">&quot;steelblue&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span> )</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="co">#ts_d &lt;- lm( passengers ~ time + treat + time.since, data=d )</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a><span class="co">#lines(d$passengers, col=&quot;steelblue&quot;, lwd=2 )</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a><span class="co">#lines( rep(1:365), col=&quot;dodgerblue4&quot;, lwd = 3 )</span></span></code></pre></div>
<p>Creating Treatment Group Y=b0+b1∗Time+b2∗Treatment+b3∗TimeSinceTreatment+e We can run the model using the lm function in R.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="co"># Passenger model variables </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a><span class="co"># y=pass, t=days, d=treatment/schedule p=time since treatment </span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a>reg_d =<span class="st"> </span><span class="kw">lm</span> ( passengers <span class="op">~</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span>treat <span class="op">+</span><span class="st"> </span>time.since)  <span class="co"># Our time series model</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true"></a><span class="kw">stargazer</span>( reg_d, </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true"></a>           <span class="dt">type =</span> <span class="st">&quot;text&quot;</span>, </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true"></a>           <span class="dt">dep.var.labels =</span> (<span class="st">&quot;Ridership&quot;</span>),</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true"></a>           <span class="dt">column.labels =</span> (<span class="st">&quot;Model results&quot;</span>),</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true"></a>           <span class="dt">covariate.labels =</span> <span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Treatment&quot;</span>, </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true"></a>                                <span class="st">&quot;Time Since Treatment&quot;</span>),</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true"></a>           <span class="dt">omit.stat =</span> <span class="st">&quot;all&quot;</span>, </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true"></a>           <span class="dt">digits =</span> <span class="dv">2</span> )</span></code></pre></div>
<pre><code>## 
## ================================================
##                          Dependent variable:    
##                      ---------------------------
##                               Ridership         
##                             Model results       
## ------------------------------------------------
## Time                           0.46***          
##                                (0.10)           
##                                                 
## Treatment                       -2.37           
##                                (14.24)          
##                                                 
## Time Since Treatment            0.22            
##                                (0.14)           
##                                                 
## Constant                     1,310.27***        
##                                (10.13)          
##                                                 
## ================================================
## ================================================
## Note:                *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
<p>Let’s interpret our coefficients: The Time coefficient indicates the ridership trend before the schedule change It’s positive and significant, indicating that ridership is increasing over time. For each day that passes, buses gain just under half a rider. The Treatment coefficient indicates the increase or decrease in ridership immediately after the schedule intervention. We can see that the immediate effect is negative indicating that ridership went down by 2.37 people. The Time Since Treatment coefficient indicates that the trend has changed after the intervention. The sustained effect is positive indicating that for each day that passes after the intervention, the bus ridership increases of 0.22 people. (These results may not be statistically significant, though we may cannot yet tell at this point) Plotting the results A useful exercise is to calculate outcomes at different points in time. For instance, we can calculate the outcome right after the intervention, which occurred at time = 182. Note that while Time = 183, Time Since Treatment is equal to 1 because it is the first day after the intervention. Y=b0+b1∗201+b2∗1+b3∗1+e We can also represent the point on a graph:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="co"># We create a small dataset with the new values</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a>data1 &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>( <span class="kw">cbind</span>( <span class="dt">time =</span> <span class="dv">184</span>, <span class="dt">treat =</span> <span class="dv">1</span>, <span class="dt">time.since =</span> <span class="dv">1</span> )) </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a><span class="co"># We use the function predict to (1) take the </span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true"></a><span class="co">#  coefficients estimated in reg_d and </span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true"></a><span class="co">#  (2) calculate the outcome Y based on the </span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true"></a><span class="co">#  values we set in the new datset</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true"></a>y1 &lt;-<span class="st"> </span><span class="kw">predict</span>( reg_d, data1 ) </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true"></a><span class="co"># We plot our initial observations, the column Y (passengers) in our dataset</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true"></a><span class="kw">plot</span>( passengers,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true"></a>      <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true"></a>      <span class="dt">col =</span> <span class="kw">gray</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>), <span class="dt">pch=</span><span class="dv">19</span>,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true"></a>      <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">365</span>), </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true"></a>      <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">1000</span>, <span class="dv">2000</span>),</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true"></a>      <span class="dt">xlab =</span> <span class="st">&quot;Time (days)&quot;</span>, </span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true"></a>      <span class="dt">ylab =</span> <span class="st">&quot;Ridership&quot;</span>)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true"></a><span class="co"># We add a point showing the level of ridership at time = 184)</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true"></a><span class="kw">points</span>( <span class="dv">184</span>, y1, <span class="dt">col =</span> <span class="st">&quot;dodgerblue4&quot;</span>, </span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true"></a>        <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">bg =</span> <span class="st">&quot;dodgerblue4&quot;</span>, <span class="dt">cex =</span> <span class="dv">2</span> )</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true"></a><span class="kw">text</span>( <span class="dv">184</span>, y1, <span class="dt">labels =</span> <span class="st">&quot;t = 184&quot;</span>, <span class="dt">pos =</span> <span class="dv">4</span>, <span class="dt">cex =</span> <span class="dv">1</span> )</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true"></a></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true"></a><span class="co"># Line marking the interruption</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true"></a><span class="kw">abline</span>( <span class="dt">v=</span><span class="dv">183</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lty=</span><span class="dv">2</span> )</span></code></pre></div>
<p>Now, we can calculate the outcome 30 days after the intervention. Time will be equal to 214 while Time Since Treatment will be equal to 30. Treatment is always equal to 1 since it is a dummy variable indicating pre or post intervention. Y=b0+b1∗230+b2∗1+b3∗30+e We can add the new point at t = 214 to the graph:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a>data2 &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>( <span class="kw">cbind</span>( <span class="dt">time =</span> <span class="dv">214</span>, <span class="dt">treat =</span> <span class="dv">1</span>, <span class="dt">time.since =</span> <span class="dv">30</span> )) <span class="co"># New data</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a>y2 &lt;-<span class="st"> </span><span class="kw">predict</span>( reg_d, data2 ) <span class="co"># We predict the new outcome</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true"></a><span class="co"># We plot our initial observations, the column Y in our dataset</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true"></a><span class="kw">plot</span>( passengers,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true"></a>      <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true"></a>      <span class="dt">col =</span> <span class="kw">gray</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>), <span class="dt">pch=</span><span class="dv">19</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true"></a>      <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">365</span>), </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true"></a>      <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">1000</span>, <span class="dv">2000</span>),</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true"></a>      <span class="dt">xlab =</span> <span class="st">&quot;Time (days)&quot;</span>, </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true"></a>      <span class="dt">ylab =</span> <span class="st">&quot;Ridership&quot;</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true"></a><span class="co"># We add a point showing the level of ridership at time = 184</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true"></a><span class="kw">points</span>(<span class="dv">184</span>, y1, <span class="dt">col =</span> <span class="st">&quot;dodgerblue4&quot;</span>, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">bg =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">cex =</span> <span class="dv">2</span>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true"></a><span class="co"># We add a new point showing the level of ridership at time = 214)</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true"></a><span class="kw">points</span>(<span class="dv">214</span>, y2, <span class="dt">col =</span> <span class="st">&quot;dodgerblue4&quot;</span>, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">bg =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">cex =</span> <span class="dv">2</span>)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true"></a><span class="co"># Label for our predicted outcome</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">184</span>, y1, <span class="dt">labels =</span> <span class="st">&quot;t = 184&quot;</span>, <span class="dt">pos =</span> <span class="dv">1</span>, <span class="dt">cex =</span> <span class="dv">1</span>)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true"></a><span class="co">#Label for the counterfactual </span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">214</span>, y2, <span class="dt">labels =</span> <span class="st">&quot;t = 214&quot;</span>, <span class="dt">pos =</span> <span class="dv">4</span>, <span class="dt">cex =</span> <span class="dv">1</span>, )</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true"></a></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true"></a><span class="co"># Line marking the interruption</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true"></a><span class="kw">abline</span>( <span class="dt">v=</span><span class="dv">183</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lty=</span><span class="dv">2</span> )</span></code></pre></div>
<p>The Counterfactual; We can calculate the counterfactual for any point in time. The counterfactual at Time = 214 is the level of ridership at that point in time if the intervention had not occured. Note the changes in our equation: Treatment and Time Since Treatment are both equal to 0. Y=b0+b1∗230+b2∗0+b3∗0+e As before, we plot the results on a graph. Y is our predict value and C is the counterfactual</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a>d5 &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>( <span class="dt">time=</span> <span class="dv">214</span>, <span class="dt">treat =</span> <span class="dv">0</span>, <span class="dt">time.since =</span> <span class="dv">0</span>)) <span class="co"># Data if the intervention does not occur</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true"></a>y3 &lt;-<span class="st"> </span><span class="kw">predict</span>(reg_d, d5) <span class="co">#Counterfactual</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true"></a><span class="co"># We plot our initial observations, the column Y in our dataset</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true"></a><span class="kw">plot</span>( passengers,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true"></a>      <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true"></a>      <span class="dt">col =</span> <span class="kw">gray</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>), <span class="dt">pch=</span><span class="dv">19</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true"></a>      <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">365</span>), </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true"></a>      <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">1000</span>, <span class="dv">2000</span>),</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true"></a>      <span class="dt">xlab =</span> <span class="st">&quot;Time (days)&quot;</span>, </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true"></a>      <span class="dt">ylab =</span> <span class="st">&quot;Ridership&quot;</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true"></a><span class="co"># We add a  point showing the level of ridsership at time = 214</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true"></a><span class="kw">points</span>(<span class="dv">214</span>, y2, <span class="dt">col =</span> <span class="st">&quot;dodgerblue4&quot;</span>, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">bg =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">cex =</span> <span class="dv">2</span>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true"></a><span class="co"># We add a point indicating the counterfactual</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true"></a><span class="kw">points</span>(<span class="dv">214</span>, y3, <span class="dt">col =</span> <span class="st">&quot;darkorange2&quot;</span>, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">cex =</span> <span class="dv">2</span>)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true"></a><span class="co"># Label for our predicted outcome</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">214</span>, y2, <span class="dt">labels =</span> <span class="st">&quot;Y at t = 230&quot;</span>, <span class="dt">pos =</span> <span class="dv">3</span>, <span class="dt">cex =</span> <span class="dv">1</span>)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true"></a><span class="co">#Label for the counterfactual </span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">214</span>, y3, <span class="dt">labels =</span> <span class="st">&quot;C at t = 230&quot;</span>, <span class="dt">pos =</span> <span class="dv">1</span>, <span class="dt">cex =</span> <span class="dv">1</span>)</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true"></a></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true"></a><span class="co"># Line marking the interruption</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true"></a><span class="kw">abline</span>( <span class="dt">v=</span><span class="dv">183</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lty=</span><span class="dv">2</span> )</span></code></pre></div>
<p>Let’s zoom in th see the minimal change</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a>d5 &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>( <span class="dt">time=</span> <span class="dv">214</span>, <span class="dt">treat =</span> <span class="dv">0</span>, <span class="dt">time.since =</span> <span class="dv">0</span>)) <span class="co"># Data if the intervention does not occur</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true"></a>y3 &lt;-<span class="st"> </span><span class="kw">predict</span>(reg_d, d5) <span class="co">#Counterfactual</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true"></a><span class="co"># We plot our initial observations, the column Y in our dataset</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true"></a><span class="kw">plot</span>( passengers,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true"></a>      <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true"></a>      <span class="dt">col =</span> <span class="kw">gray</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>), <span class="dt">pch=</span><span class="dv">19</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true"></a>      <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">184</span>, <span class="dv">230</span>), </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true"></a>      <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">1400</span>, <span class="dv">1430</span>),</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true"></a>      <span class="dt">xlab =</span> <span class="st">&quot;Time (days)&quot;</span>, </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true"></a>      <span class="dt">ylab =</span> <span class="st">&quot;Ridership&quot;</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true"></a><span class="co"># We add a  point showing the level of ridsership at time = 214</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true"></a><span class="kw">points</span>(<span class="dv">214</span>, y2, <span class="dt">col =</span> <span class="st">&quot;dodgerblue4&quot;</span>, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">bg =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">cex =</span> <span class="dv">2</span>)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true"></a><span class="co"># We add a point indicating the counterfactual</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true"></a><span class="kw">points</span>(<span class="dv">214</span>, y3, <span class="dt">col =</span> <span class="st">&quot;darkorange2&quot;</span>, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">cex =</span> <span class="dv">2</span>)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true"></a><span class="co"># Label for our predicted outcome</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">214</span>, y2, <span class="dt">labels =</span> <span class="st">&quot;Y at t = 230&quot;</span>, <span class="dt">pos =</span> <span class="dv">1</span>, <span class="dt">cex =</span> <span class="dv">1</span>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true"></a></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true"></a><span class="co">#Label for the counterfactual </span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">214</span>, y3, <span class="dt">labels =</span> <span class="st">&quot;C at t = 230&quot;</span>, <span class="dt">pos =</span> <span class="dv">1</span>, <span class="dt">cex =</span> <span class="dv">1</span>)</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true"></a></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true"></a><span class="co"># Line marking the interruption</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true"></a><span class="kw">abline</span>( <span class="dt">v=</span><span class="dv">183</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lty=</span><span class="dv">2</span> )</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true"></a></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true"></a><span class="kw">text</span>( <span class="dv">200</span>, <span class="dv">1422</span>, <span class="st">&quot;Statistically Insignificant Change&quot;</span>, <span class="dt">col=</span><span class="st">&quot;firebrick&quot;</span>, <span class="dt">cex=</span><span class="fl">1.0</span>, <span class="dt">pos=</span><span class="dv">4</span> )</span></code></pre></div>
<p>This changes only slightly by choosing different days to compare.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a>d6 &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>( <span class="dt">time =</span> <span class="dv">320</span>, <span class="dt">treat =</span> <span class="dv">1</span>, <span class="dt">time.since =</span><span class="dv">183</span>)) </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a>d7 &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>( <span class="dt">time =</span> <span class="dv">320</span>, <span class="dt">treat =</span> <span class="dv">0</span>, <span class="dt">time.since =</span> <span class="dv">0</span>))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true"></a>y4 &lt;-<span class="st"> </span><span class="kw">predict</span>(reg_d, d6)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true"></a>y5 &lt;-<span class="st"> </span><span class="kw">predict</span>(reg_d, d7)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true"></a><span class="co"># We plot our initial observations, the column Y in our dataset</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true"></a><span class="kw">plot</span>( passengers,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true"></a>      <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true"></a>      <span class="dt">col =</span> <span class="kw">gray</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>), <span class="dt">pch=</span><span class="dv">19</span>,</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true"></a>      <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">365</span>), </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true"></a>      <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">1000</span>, <span class="dv">2000</span>),</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true"></a>      <span class="dt">xlab =</span> <span class="st">&quot;Time (days)&quot;</span>, </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true"></a>      <span class="dt">ylab =</span> <span class="st">&quot;Ridership&quot;</span>)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true"></a><span class="co"># ridership at time = 214</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true"></a><span class="kw">points</span>(<span class="dv">214</span>, y2, <span class="dt">col =</span> <span class="st">&quot;dodgerblue4&quot;</span>, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">bg =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">cex =</span> <span class="fl">.6</span>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true"></a><span class="co"># Counterfactual at time = 214</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true"></a><span class="kw">points</span>(<span class="dv">214</span>, y3, <span class="dt">col =</span> <span class="st">&quot;darkorange2&quot;</span>, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">cex =</span> <span class="fl">.6</span>)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true"></a><span class="co"># ridership at time = 320</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true"></a><span class="kw">points</span>(<span class="dv">320</span>, y4, <span class="dt">col =</span> <span class="st">&quot;dodgerblue4&quot;</span>, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">cex =</span> <span class="fl">.6</span>)</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true"></a></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true"></a><span class="co"># Counterfactual at time = 320</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true"></a><span class="kw">points</span>(<span class="dv">320</span>, y5, <span class="dt">col =</span> <span class="st">&quot;darkorange2&quot;</span>, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">cex =</span> <span class="fl">.6</span>)</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true"></a></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true"></a><span class="co"># Adding labels</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">320</span>, y4, <span class="dt">labels =</span> <span class="st">&quot;Y at t=320&quot;</span>, <span class="dt">pos =</span> <span class="dv">4</span>, <span class="dt">cex =</span> <span class="fl">.9</span>)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">320</span>, y5, <span class="dt">labels =</span> <span class="st">&quot;C at t=320&quot;</span>, <span class="dt">pos =</span> <span class="dv">4</span>, <span class="dt">cex =</span> <span class="fl">.9</span>)</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">230</span>, y2, <span class="dt">labels =</span> <span class="st">&quot;Y at at=214&quot;</span>, <span class="dt">pos =</span> <span class="dv">1</span>, <span class="dt">cex =</span> <span class="dv">1</span>)</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">230</span>, y3, <span class="dt">labels =</span> <span class="st">&quot;C at t=214&quot;</span>, <span class="dt">pos =</span> <span class="dv">4</span>, <span class="dt">cex =</span> <span class="dv">1</span>)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true"></a></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true"></a><span class="co"># Line marking the interruption</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true"></a><span class="kw">abline</span>( <span class="dt">v=</span><span class="dv">183</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lty=</span><span class="dv">2</span> )</span></code></pre></div>
<p>Again, they are very close together, at 30 days post policy, however they are further separated at 183 days after thew policy, and we can now plot the predicted outcomes of the policy change.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a>pred1 &lt;-<span class="st"> </span><span class="kw">predict</span>(reg_d, d) </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a><span class="co"># To estimate all predicted values of Y, we just use our dataset</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true"></a>datanew &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(<span class="dt">time =</span> <span class="kw">rep</span>(<span class="dv">1</span> <span class="op">:</span><span class="st"> </span><span class="dv">365</span>), <span class="dt">treat =</span> <span class="kw">rep</span>(<span class="dv">0</span>), <span class="dt">passengers =</span> <span class="kw">rep</span>(<span class="dv">0</span>))) </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true"></a><span class="co"># Create a new dataset where Treatment and Time Since Treatment are equal to 0 as the intervention did not occur.</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true"></a>pred2 &lt;-<span class="st"> </span><span class="kw">predict</span>(reg_d, datanew) </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true"></a><span class="co"># Predict the counterfactuals</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true"></a><span class="kw">plot</span>( passengers,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true"></a>      <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true"></a>      <span class="dt">col =</span> <span class="kw">gray</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>), <span class="dt">pch=</span><span class="dv">19</span>,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true"></a>      <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">365</span>), </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true"></a>      <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">1000</span>, <span class="dv">2000</span>),</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true"></a>      <span class="dt">xlab =</span> <span class="st">&quot;Time (days)&quot;</span>, </span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true"></a>      <span class="dt">ylab =</span> <span class="st">&quot;Ridership&quot;</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true"></a><span class="kw">lines</span>( <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">182</span>), pred1[<span class="dv">1</span><span class="op">:</span><span class="dv">182</span>], <span class="dt">col=</span><span class="st">&quot;dodgerblue4&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span> )</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true"></a><span class="kw">lines</span>( <span class="kw">rep</span>(<span class="dv">184</span><span class="op">:</span><span class="dv">365</span>), pred1[<span class="dv">184</span><span class="op">:</span><span class="dv">365</span>], <span class="dt">col=</span><span class="st">&quot;dodgerblue4&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span> )</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true"></a><span class="kw">lines</span>( <span class="kw">rep</span>(<span class="dv">183</span><span class="op">:</span><span class="dv">365</span>), pred2[<span class="dv">183</span><span class="op">:</span><span class="dv">365</span>], <span class="dt">col=</span><span class="st">&quot;darkorange2&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">lty =</span> <span class="dv">5</span> ) </span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">0</span>, <span class="dv">1200</span>, <span class="dt">labels =</span> <span class="st">&quot;Predicted values&quot;</span>, <span class="dt">pos =</span> <span class="dv">4</span>, <span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;dodgerblue3&quot;</span>)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">300</span>, <span class="dv">1400</span>, <span class="dt">labels =</span> <span class="st">&quot;Counterfactual&quot;</span>, <span class="dt">pos =</span> <span class="dv">4</span>, <span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;darkorange2&quot;</span>)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true"></a></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true"></a><span class="co"># Line marking the interruption</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true"></a><span class="kw">abline</span>( <span class="dt">v=</span><span class="dv">183</span>, <span class="dt">col=</span><span class="st">&quot;darkorange2&quot;</span>, <span class="dt">lty=</span><span class="dv">2</span> )</span></code></pre></div>
<p>A Closer look into the predicted change.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a>pred1 &lt;-<span class="st"> </span><span class="kw">predict</span>(reg_d, d) </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true"></a><span class="co"># To estimate all predicted values of Y, we just use our dataset</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true"></a>datanew &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(<span class="dt">time =</span> <span class="kw">rep</span>(<span class="dv">1</span> <span class="op">:</span><span class="st"> </span><span class="dv">365</span>), <span class="dt">treat =</span> <span class="kw">rep</span>(<span class="dv">0</span>), <span class="dt">passengers =</span> <span class="kw">rep</span>(<span class="dv">0</span>))) </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true"></a><span class="co"># Create a new dataset where Treatment and Time Since Treatment are equal to 0 as the intervention did not occur.</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true"></a>pred2 &lt;-<span class="st"> </span><span class="kw">predict</span>(reg_d, datanew) </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true"></a><span class="co"># Predict the counterfactuals</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true"></a><span class="kw">plot</span>( passengers,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true"></a>      <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true"></a>      <span class="dt">col =</span> <span class="kw">gray</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>), <span class="dt">pch=</span><span class="dv">19</span>,</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true"></a>      <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">180</span>, <span class="dv">365</span>), </span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true"></a>      <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">1350</span>, <span class="dv">1520</span>),</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true"></a>      <span class="dt">xlab =</span> <span class="st">&quot;Time (days)&quot;</span>, </span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true"></a>      <span class="dt">ylab =</span> <span class="st">&quot;Ridership&quot;</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true"></a><span class="kw">lines</span>( <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">182</span>), pred1[<span class="dv">1</span><span class="op">:</span><span class="dv">182</span>], <span class="dt">col=</span><span class="st">&quot;dodgerblue4&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span> )</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true"></a><span class="kw">lines</span>( <span class="kw">rep</span>(<span class="dv">184</span><span class="op">:</span><span class="dv">365</span>), pred1[<span class="dv">184</span><span class="op">:</span><span class="dv">365</span>], <span class="dt">col=</span><span class="st">&quot;dodgerblue4&quot;</span>, <span class="dt">lwd =</span> <span class="fl">1.5</span> )</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true"></a><span class="kw">lines</span>( <span class="kw">rep</span>(<span class="dv">183</span><span class="op">:</span><span class="dv">365</span>), pred2[<span class="dv">183</span><span class="op">:</span><span class="dv">365</span>], <span class="dt">col=</span><span class="st">&quot;darkorange2&quot;</span>, <span class="dt">lwd =</span> <span class="fl">1.5</span>, <span class="dt">lty =</span> <span class="dv">5</span> ) </span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true"></a></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">0</span>, <span class="dv">1200</span>, <span class="dt">labels =</span> <span class="st">&quot;Predicted values&quot;</span>, <span class="dt">pos =</span> <span class="dv">4</span>, <span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;dodgerblue3&quot;</span>)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">300</span>, <span class="dv">1400</span>, <span class="dt">labels =</span> <span class="st">&quot;Counterfactual&quot;</span>, <span class="dt">pos =</span> <span class="dv">4</span>, <span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;darkorange2&quot;</span>)</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true"></a></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true"></a><span class="co"># Line marking the interruption</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true"></a><span class="kw">abline</span>( <span class="dt">v=</span><span class="dv">183</span>, <span class="dt">col=</span><span class="st">&quot;darkorange2&quot;</span>, <span class="dt">lty=</span><span class="dv">2</span> )</span></code></pre></div>
<p>As we can see, there is a marginal increase in ridership however we do not know the difference.</p>
<p>Delayed Effects in Time Series</p>
<p>Note that the coefficients obtained from the previous equations do not tell us if the difference between each point (the predicted outcomes) and its counterfactual is statistically significant. They only tell you if there is an immediate change after the intervention and the slope has changed after the intervention. There is no statistical test to look at whether there is a statistically significant difference between a predicted outcome and its counterfactual. This has important implications. It could be that effect of the intervention varies over time.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a>reg_d2 =<span class="st"> </span><span class="kw">lm</span>(passengers <span class="op">~</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span>treat <span class="op">+</span><span class="st"> </span>time.since, <span class="dt">data =</span> d)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true"></a><span class="kw">stargazer</span>( reg_d2, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true"></a>           <span class="dt">type =</span> <span class="st">&quot;text&quot;</span>, </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true"></a>           <span class="dt">dep.var.labels =</span> (<span class="st">&quot;Ridership&quot;</span>),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true"></a>           <span class="dt">column.labels =</span> (<span class="st">&quot;Model results&quot;</span>),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true"></a>           <span class="dt">covariate.labels =</span> <span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Treatment&quot;</span>, <span class="st">&quot;Time Since Treatment&quot;</span>),</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true"></a>           <span class="dt">omit.stat =</span> <span class="st">&quot;all&quot;</span>, </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true"></a>           <span class="dt">digits =</span> <span class="dv">2</span> )</span></code></pre></div>
<pre><code>## 
## ================================================
##                          Dependent variable:    
##                      ---------------------------
##                               Ridership         
##                             Model results       
## ------------------------------------------------
## Time                           0.46***          
##                                (0.10)           
##                                                 
## Treatment                       -2.37           
##                                (14.24)          
##                                                 
## Time Since Treatment            0.22            
##                                (0.14)           
##                                                 
## Constant                     1,310.27***        
##                                (10.13)          
##                                                 
## ================================================
## ================================================
## Note:                *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
<p>Measuring at day 300</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a>pred1 &lt;-<span class="st"> </span><span class="kw">predict</span>(reg_d, d) </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true"></a><span class="co"># To estimate all predicted values of Y, we just use our dataset</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true"></a>datanew &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(<span class="dt">time =</span> <span class="kw">rep</span>(<span class="dv">1</span> <span class="op">:</span><span class="st"> </span><span class="dv">365</span>), <span class="dt">treat =</span> <span class="kw">rep</span>(<span class="dv">0</span>), <span class="dt">passengers =</span> <span class="kw">rep</span>(<span class="dv">0</span>))) </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true"></a><span class="co"># Create a new dataset where Treatment and Time Since Treatment are equal to 0 as the intervention did not occur.</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true"></a>pred2 &lt;-<span class="st"> </span><span class="kw">predict</span>(reg_d, datanew) </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true"></a><span class="co"># Predict the counterfactuals</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true"></a><span class="kw">plot</span>( passengers,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true"></a>      <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true"></a>      <span class="dt">col =</span> <span class="kw">gray</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>), <span class="dt">pch=</span><span class="dv">19</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true"></a>      <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">365</span>), </span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true"></a>      <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">1000</span>, <span class="dv">2000</span>),</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true"></a>      <span class="dt">xlab =</span> <span class="st">&quot;Time (days)&quot;</span>, </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true"></a>      <span class="dt">ylab =</span> <span class="st">&quot;Ridership&quot;</span>)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true"></a><span class="kw">lines</span>( <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">182</span>), pred1[<span class="dv">1</span><span class="op">:</span><span class="dv">182</span>], <span class="dt">col=</span><span class="st">&quot;dodgerblue4&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span> )</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true"></a><span class="kw">lines</span>( <span class="kw">rep</span>(<span class="dv">184</span><span class="op">:</span><span class="dv">365</span>), pred1[<span class="dv">184</span><span class="op">:</span><span class="dv">365</span>], <span class="dt">col=</span><span class="st">&quot;dodgerblue4&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span> )</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true"></a><span class="kw">lines</span>( <span class="kw">rep</span>(<span class="dv">183</span><span class="op">:</span><span class="dv">365</span>), pred2[<span class="dv">183</span><span class="op">:</span><span class="dv">365</span>], <span class="dt">col=</span><span class="st">&quot;darkorange2&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">lty =</span> <span class="dv">5</span> ) </span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">0</span>, <span class="dv">1200</span>, <span class="dt">labels =</span> <span class="st">&quot;Predicted values&quot;</span>, <span class="dt">pos =</span> <span class="dv">4</span>, <span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;dodgerblue3&quot;</span>)</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">300</span>, <span class="dv">1400</span>, <span class="dt">labels =</span> <span class="st">&quot;Counterfactual&quot;</span>, <span class="dt">pos =</span> <span class="dv">4</span>, <span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;darkorange2&quot;</span>)</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true"></a></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true"></a><span class="co"># Line marking the interruption</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true"></a><span class="kw">abline</span>( <span class="dt">v=</span><span class="dv">183</span>, <span class="dt">col=</span><span class="st">&quot;darkorange2&quot;</span>, <span class="dt">lty=</span><span class="dv">2</span> )</span></code></pre></div>
<p><img src="DSProj1_Transport_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true"></a><span class="co">#abline( v=300, col=&quot;forestgreen&quot;, lty=2 )</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true"></a>pred1 &lt;-<span class="st"> </span><span class="kw">predict</span>(reg_d, d) </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true"></a><span class="co"># To estimate all predicted values of Y, we just use our dataset</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true"></a>datanew &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(<span class="dt">time =</span> <span class="kw">rep</span>(<span class="dv">1</span> <span class="op">:</span><span class="st"> </span><span class="dv">365</span>), <span class="dt">treat =</span> <span class="kw">rep</span>(<span class="dv">0</span>), <span class="dt">passengers =</span> <span class="kw">rep</span>(<span class="dv">0</span>))) </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true"></a><span class="co"># Create a new dataset where Treatment and Time Since Treatment are equal to 0 as the intervention did not occur.</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true"></a>pred2 &lt;-<span class="st"> </span><span class="kw">predict</span>(reg_d, datanew) </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true"></a><span class="co"># Predict the counterfactuals</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true"></a><span class="kw">plot</span>( passengers,</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true"></a>      <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true"></a>      <span class="dt">col =</span> <span class="kw">gray</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>), <span class="dt">pch=</span><span class="dv">19</span>,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true"></a>      <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">180</span>, <span class="dv">365</span>), </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true"></a>      <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">1350</span>, <span class="dv">1520</span>),</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true"></a>      <span class="dt">xlab =</span> <span class="st">&quot;Time (days)&quot;</span>, </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true"></a>      <span class="dt">ylab =</span> <span class="st">&quot;Ridership&quot;</span>)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true"></a><span class="kw">lines</span>( <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">182</span>), pred1[<span class="dv">1</span><span class="op">:</span><span class="dv">182</span>], <span class="dt">col=</span><span class="st">&quot;dodgerblue4&quot;</span>, <span class="dt">lwd =</span> <span class="fl">1.5</span> )</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true"></a><span class="kw">lines</span>( <span class="kw">rep</span>(<span class="dv">184</span><span class="op">:</span><span class="dv">365</span>), pred1[<span class="dv">184</span><span class="op">:</span><span class="dv">365</span>], <span class="dt">col=</span><span class="st">&quot;dodgerblue4&quot;</span>, <span class="dt">lwd =</span> <span class="fl">1.5</span> )</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true"></a><span class="kw">lines</span>( <span class="kw">rep</span>(<span class="dv">183</span><span class="op">:</span><span class="dv">365</span>), pred2[<span class="dv">183</span><span class="op">:</span><span class="dv">365</span>], <span class="dt">col=</span><span class="st">&quot;darkorange2&quot;</span>, <span class="dt">lwd =</span> <span class="fl">1.5</span>, <span class="dt">lty =</span> <span class="dv">5</span> ) </span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true"></a></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">0</span>, <span class="dv">1200</span>, <span class="dt">labels =</span> <span class="st">&quot;Predicted values&quot;</span>, <span class="dt">pos =</span> <span class="dv">4</span>, <span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;dodgerblue3&quot;</span>)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">300</span>, <span class="dv">1400</span>, <span class="dt">labels =</span> <span class="st">&quot;Counterfactual&quot;</span>, <span class="dt">pos =</span> <span class="dv">4</span>, <span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;darkorange2&quot;</span>)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true"></a></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true"></a><span class="co"># Line marking the interruption</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true"></a><span class="co">#abline( v=300, col=&quot;forestgreen&quot;, lty=2 )</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true"></a><span class="kw">abline</span>( <span class="dt">v=</span><span class="dv">183</span>, <span class="dt">col=</span><span class="st">&quot;darkorange2&quot;</span>, <span class="dt">lty=</span><span class="dv">2</span> )</span></code></pre></div>
<p><img src="DSProj1_Transport_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>Brief analysis:</p>
<p>-The intercept is the constant slope of the line before the change in bus policy. -The time coefficient represents which day of the year it is. -The coefficient that represents the immediate effect of the policy would be within the time since treatment, specifically the first day after the implementation, so the 184th day of the year. -The sustained effect of the policy can be summarized as the slope of ridership over days 184-365 during the time since treatment -The policy has slightly decreased ridership in the second half of the year, we can see that the outcome was that ridership was down by just over 2 passengers, however the results were not statistically significant. -The overall trend of the policy appears to have increased ridership slightly over the time period by less than a single passenger per day, however this is not a statistically significant result. -These results can be explained by the behavior of the riders, which could have remained the same, the same number of people are taking the bus, though as the increased schedule was implemented, many of them could have simply gotten to their destinations faster due to the increased schedule.</p>
<p>Predicted caounterfactual of ridership compared to control</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true"></a>pred1 &lt;-<span class="st"> </span><span class="kw">predict</span>(reg_d, d) </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true"></a><span class="co"># To estimate all predicted values of Y, we just use our dataset</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true"></a>datanew &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(<span class="dt">time =</span> <span class="kw">rep</span>(<span class="dv">1</span> <span class="op">:</span><span class="st"> </span><span class="dv">365</span>), <span class="dt">treat =</span> <span class="kw">rep</span>(<span class="dv">0</span>), <span class="dt">passengers =</span> <span class="kw">rep</span>(<span class="dv">0</span>))) </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true"></a><span class="co"># Create a new dataset where Treatment and Time Since Treatment are equal to 0 as the intervention did not occur.</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true"></a>pred2 &lt;-<span class="st"> </span><span class="kw">predict</span>(reg_d, datanew) </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true"></a><span class="co"># Predict the counterfactuals</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true"></a><span class="kw">plot</span>( passengers,</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true"></a>      <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true"></a>      <span class="dt">col =</span> <span class="kw">gray</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>), <span class="dt">pch=</span><span class="dv">19</span>,</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true"></a>      <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">365</span>), </span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true"></a>      <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">1000</span>, <span class="dv">2000</span>),</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true"></a>      <span class="dt">xlab =</span> <span class="st">&quot;Time (days)&quot;</span>, </span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true"></a>      <span class="dt">ylab =</span> <span class="st">&quot;Ridership&quot;</span>)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true"></a></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true"></a><span class="kw">lines</span>( <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">182</span>), pred1[<span class="dv">1</span><span class="op">:</span><span class="dv">182</span>], <span class="dt">col=</span><span class="st">&quot;dodgerblue4&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span> )</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true"></a><span class="kw">lines</span>( <span class="kw">rep</span>(<span class="dv">184</span><span class="op">:</span><span class="dv">365</span>), pred1[<span class="dv">184</span><span class="op">:</span><span class="dv">365</span>], <span class="dt">col=</span><span class="st">&quot;dodgerblue4&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span> )</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true"></a><span class="kw">lines</span>( <span class="kw">rep</span>(<span class="dv">183</span><span class="op">:</span><span class="dv">365</span>), pred2[<span class="dv">183</span><span class="op">:</span><span class="dv">365</span>], <span class="dt">col=</span><span class="st">&quot;darkorange2&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">lty =</span> <span class="dv">5</span> ) </span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true"></a></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">0</span>, <span class="dv">1200</span>, <span class="dt">labels =</span> <span class="st">&quot;Predicted values&quot;</span>, <span class="dt">pos =</span> <span class="dv">4</span>, <span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;dodgerblue3&quot;</span>)</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">300</span>, <span class="dv">1400</span>, <span class="dt">labels =</span> <span class="st">&quot;Counterfactual&quot;</span>, <span class="dt">pos =</span> <span class="dv">4</span>, <span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;darkorange2&quot;</span>)</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">200</span>, <span class="dv">1800</span>, <span class="dt">labels =</span> <span class="st">&quot;100 Days after Policy&quot;</span>, <span class="dt">pos =</span> <span class="dv">4</span>, <span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;forestgreen&quot;</span>)</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true"></a><span class="co"># Line marking the interruption</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true"></a><span class="kw">abline</span>( <span class="dt">v=</span><span class="dv">183</span>, <span class="dt">col=</span><span class="st">&quot;darkorange2&quot;</span>, <span class="dt">lty=</span><span class="dv">2</span> )</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true"></a><span class="kw">abline</span>( <span class="dt">v=</span><span class="dv">284</span>, <span class="dt">col=</span><span class="st">&quot;forestgreen&quot;</span>, <span class="dt">lty=</span><span class="dv">2</span> )</span></code></pre></div>
<p><img src="DSProj1_Transport_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true"></a>d7&lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>( <span class="dt">time=</span> <span class="dv">284</span>, <span class="dt">treat =</span> <span class="dv">0</span>, <span class="dt">time.since =</span> <span class="dv">0</span>)) <span class="co"># Data if the intervention does not occur</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true"></a>y7 &lt;-<span class="st"> </span><span class="kw">predict</span>(reg_d, d7) <span class="co">#Counterfactual</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true"></a><span class="co"># We plot our initial observations, the column Y in our dataset</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true"></a><span class="kw">plot</span>( passengers,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true"></a>      <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true"></a>      <span class="dt">col =</span> <span class="kw">gray</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>), <span class="dt">pch=</span><span class="dv">19</span>,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true"></a>      <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">365</span>), </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true"></a>      <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">1350</span>, <span class="dv">1500</span>),</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true"></a>      <span class="dt">xlab =</span> <span class="st">&quot;Time (days)&quot;</span>, </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true"></a>      <span class="dt">ylab =</span> <span class="st">&quot;Ridership&quot;</span>)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true"></a><span class="co"># We add a  point showing the level of ridsership at time = 214</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true"></a><span class="kw">points</span>(<span class="dv">284</span>, y2, <span class="dt">col =</span> <span class="st">&quot;dodgerblue4&quot;</span>, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">bg =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">cex =</span> <span class="dv">1</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true"></a><span class="co"># We add a point indicating the counterfactual</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true"></a><span class="kw">points</span>(<span class="dv">284</span>, y3, <span class="dt">col =</span> <span class="st">&quot;darkorange2&quot;</span>, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">cex =</span> <span class="dv">1</span>)</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true"></a></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true"></a><span class="co"># Label for our predicted outcome</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">284</span>, y2, <span class="dt">labels =</span> <span class="st">&quot;Y at t = 230&quot;</span>, <span class="dt">pos =</span> <span class="dv">3</span>, <span class="dt">cex =</span> <span class="dv">1</span>)</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true"></a></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true"></a><span class="co">#Label for the counterfactual </span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">284</span>, y3, <span class="dt">labels =</span> <span class="st">&quot;C at t = 230&quot;</span>, <span class="dt">pos =</span> <span class="dv">1</span>, <span class="dt">cex =</span> <span class="dv">1</span>)</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true"></a></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true"></a><span class="co"># Line marking the interruption</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true"></a><span class="kw">abline</span>( <span class="dt">v=</span><span class="dv">183</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lty=</span><span class="dv">2</span> )</span></code></pre></div>
<p><br> <br></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a>pred1 &lt;-<span class="st"> </span><span class="kw">predict</span>(reg_d, d) </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true"></a><span class="co"># To estimate all predicted values of Y, we just use our dataset</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true"></a>datanew &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(<span class="dt">time =</span> <span class="kw">rep</span>(<span class="dv">1</span> <span class="op">:</span><span class="st"> </span><span class="dv">365</span>), <span class="dt">treat =</span> <span class="kw">rep</span>(<span class="dv">0</span>), <span class="dt">passengers =</span> <span class="kw">rep</span>(<span class="dv">0</span>))) </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true"></a><span class="co"># Create a new dataset where Treatment and Time Since Treatment are equal to 0 as the intervention did not occur.</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true"></a>pred2 &lt;-<span class="st"> </span><span class="kw">predict</span>(reg_d, datanew) </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true"></a><span class="co"># Predict the counterfactuals</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true"></a><span class="kw">plot</span>( passengers,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true"></a>      <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true"></a>      <span class="dt">col =</span> <span class="kw">gray</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>), <span class="dt">pch=</span><span class="dv">19</span>,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true"></a>      <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">365</span>), </span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true"></a>      <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">1000</span>, <span class="dv">2000</span>),</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true"></a>      <span class="dt">xlab =</span> <span class="st">&quot;Time (days)&quot;</span>, </span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true"></a>      <span class="dt">ylab =</span> <span class="st">&quot;Ridership&quot;</span>)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true"></a></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true"></a><span class="kw">lines</span>( <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">182</span>), pred1[<span class="dv">1</span><span class="op">:</span><span class="dv">182</span>], <span class="dt">col=</span><span class="st">&quot;dodgerblue4&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span> )</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true"></a><span class="kw">lines</span>( <span class="kw">rep</span>(<span class="dv">184</span><span class="op">:</span><span class="dv">365</span>), pred1[<span class="dv">184</span><span class="op">:</span><span class="dv">365</span>], <span class="dt">col=</span><span class="st">&quot;dodgerblue4&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span> )</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true"></a><span class="kw">lines</span>( <span class="kw">rep</span>(<span class="dv">183</span><span class="op">:</span><span class="dv">365</span>), pred2[<span class="dv">183</span><span class="op">:</span><span class="dv">365</span>], <span class="dt">col=</span><span class="st">&quot;darkorange2&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">lty =</span> <span class="dv">5</span> ) </span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true"></a></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">0</span>, <span class="dv">1200</span>, <span class="dt">labels =</span> <span class="st">&quot;Predicted values&quot;</span>, <span class="dt">pos =</span> <span class="dv">4</span>, <span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;dodgerblue3&quot;</span>)</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">300</span>, <span class="dv">1400</span>, <span class="dt">labels =</span> <span class="st">&quot;Counterfactual&quot;</span>, <span class="dt">pos =</span> <span class="dv">4</span>, <span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;darkorange2&quot;</span>)</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">200</span>, <span class="dv">1800</span>, <span class="dt">labels =</span> <span class="st">&quot;150 Days after Policy&quot;</span>, <span class="dt">pos =</span> <span class="dv">4</span>, <span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;forestgreen&quot;</span>)</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true"></a><span class="co"># Line marking the interruption</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true"></a><span class="kw">abline</span>( <span class="dt">v=</span><span class="dv">183</span>, <span class="dt">col=</span><span class="st">&quot;darkorange2&quot;</span>, <span class="dt">lty=</span><span class="dv">2</span> )</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true"></a><span class="kw">abline</span>( <span class="dt">v=</span><span class="dv">334</span>, <span class="dt">col=</span><span class="st">&quot;forestgreen&quot;</span>, <span class="dt">lty=</span><span class="dv">2</span> )</span></code></pre></div>
<p><img src="DSProj1_Transport_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a>d7&lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>( <span class="dt">time=</span> <span class="dv">334</span>, <span class="dt">treat =</span> <span class="dv">0</span>, <span class="dt">time.since =</span> <span class="dv">0</span>)) <span class="co"># Data if the intervention does not occur</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true"></a>y7 &lt;-<span class="st"> </span><span class="kw">predict</span>(reg_d, d7) <span class="co">#Counterfactual</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true"></a><span class="co"># We plot our initial observations, the column Y in our dataset</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true"></a><span class="kw">plot</span>( passengers,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true"></a>      <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true"></a>      <span class="dt">col =</span> <span class="kw">gray</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>), <span class="dt">pch=</span><span class="dv">19</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true"></a>      <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">365</span>), </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true"></a>      <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">1350</span>, <span class="dv">1500</span>),</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true"></a>      <span class="dt">xlab =</span> <span class="st">&quot;Time (days)&quot;</span>, </span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true"></a>      <span class="dt">ylab =</span> <span class="st">&quot;Ridership&quot;</span>)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true"></a></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true"></a><span class="co"># We add a  point showing the level of ridsership at time = 214</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true"></a><span class="kw">points</span>(<span class="dv">334</span>, y2, <span class="dt">col =</span> <span class="st">&quot;dodgerblue4&quot;</span>, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">bg =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">cex =</span> <span class="dv">1</span>)</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true"></a></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true"></a><span class="co"># We add a point indicating the counterfactual</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true"></a><span class="kw">points</span>(<span class="dv">334</span>, y3, <span class="dt">col =</span> <span class="st">&quot;darkorange2&quot;</span>, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">cex =</span> <span class="dv">1</span>)</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true"></a></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true"></a><span class="co"># Label for our predicted outcome</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">334</span>, y2, <span class="dt">labels =</span> <span class="st">&quot;Y at t = 230&quot;</span>, <span class="dt">pos =</span> <span class="dv">3</span>, <span class="dt">cex =</span> <span class="dv">1</span>)</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true"></a></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true"></a><span class="co">#Label for the counterfactual </span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">334</span>, y3, <span class="dt">labels =</span> <span class="st">&quot;C at t = 230&quot;</span>, <span class="dt">pos =</span> <span class="dv">1</span>, <span class="dt">cex =</span> <span class="dv">1</span>)</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true"></a></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true"></a><span class="co"># Line marking the interruption</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true"></a><span class="kw">abline</span>( <span class="dt">v=</span><span class="dv">183</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lty=</span><span class="dv">2</span> )</span></code></pre></div>
<p>Brief analysis: -The predicted number of passengers 100 days post policy is 1425 passengers -The counterfactual is the estimation of the number of passengers that would have ridden the bus should the policy not have been implemented -1475 passengers are riding 150 days post treatment -The two counterfactuals are not the same, and cannot be concluded as predictive because ridership is gradually increasing over time, regardless of the treatment policy</p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
